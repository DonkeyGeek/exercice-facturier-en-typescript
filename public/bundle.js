(()=>{"use strict";class t{constructor(t,e,s,n,i,o,r,a,l,d,c,h){this.documentType=t,this.firstName=e,this.lastName=s,this.address=n,this.country=i,this.town=o,this.zip=r,this.product=a,this.price=l,this.quantity=d,this.tva=c,this.date=h}subtotal(t,e,s){return(t+t*(s/100))*e}htmlFormat(){const t=this.subtotal(this.price,this.quantity,this.tva);return`\n        <div class="row p-5">\n            <div class="col-md-6">\n                <h2 class="text-left">LOGO</h2>\n            </div>\n            <div class="col-md-6 text-right">\n                <p class="font-weight-bold mb-1">${"invoice"===this.documentType?"Facture":"Devis"}<span class="font-weight-normal"> N° ${Math.floor(101*Math.random())}</span></p>\n                <p class="font-weight-bold mb-1">Date <span class="font-weight-normal">${this.date.toLocaleDateString()}</span></p>\n            </div>\n        </div>\n\n        <div class="row pb-5 p-5">\n            <div class="col-sm-6 text-left">\n                <p class="font-weight-bold">Entreprise de Toto</p>\n                <p class="mb-1">22 boulevard Moe Szyslak</p>\n                <p>75008 - Paris</p>\n                <p class="mb-1">Tél: 00.00.00.00.00</p>\n            </div>\n\n            <div class="col-sm-6 text-right">\n                <p class="font-weight-bold">Informations du client</p>\n                <p class="mb-1">Mr/Mme ${this.firstName} ${this.lastName}</p>\n                <p class="mb-1">${this.address}</p>\n                <p>${this.zip}</p>\n                <p>${this.town}</p>\n                <p>${this.country}</p>\n            </div>\n        </div>\n\n        <div class="row p-5">\n        <div class="col-md-12">\n            <table class="table">\n                <thead>\n                    <tr>\n                    <th class="border-0 text-uppercase small font-weight-bold">Produit/Service</th>\n                    <th class="border-0 text-uppercase small font-weight-bold">Prix unitaire HT</th>\n                    <th class="border-0 text-uppercase small font-weight-bold">Quantité</th>\n                    <th class="border-0 text-uppercase small font-weight-bold">Total HT</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr>\n                    <td>${this.product}</td>\n                    <td>${this.price} € HT</td>\n                    <td>${this.quantity}</td>\n                    <td>${this.price*this.quantity} € HT</td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n    </div>\n\n    <div class="d-flex flex-row-reverse bg-light p-4">\n        <div class="py-3 px-5">\n            <div class="mb-2">TOTAL TTC</div>\n            <div class="h2 font-weight-light"> ${t.toFixed(2)} €</div>\n        </div>\n    </div>\n        `}}class e{constructor(t,e){this.oldData=[],this.setItem(t,e)}static checkLocalStorage(){null===localStorage.getItem("invoice")&&localStorage.setItem("invoice","[]"),null===localStorage.getItem("estimate")&&localStorage.setItem("estimate","[]")}setItem(t,e){let s;s=localStorage.getItem(t),null!==s?(this.oldData=JSON.parse(s),this.oldData.push(e),localStorage.setItem(t,JSON.stringify(this.oldData))):document.location.reload()}}class s{constructor(t,e,s){this.container=t,this.hiddenDiv=e,this.btnPrint=s,this.formContainer=document.getElementById("form-container")}render(t,s){const n=t.htmlFormat();this.container.innerHTML=n,new e(s,n),this.btnPrint.innerText="invoice"===s?"Imprimer la facture":"Imprimer le devis",this.hiddenDiv.classList.remove("invisible"),this.formContainer.innerHTML=""}}class n{constructor(t){this.el=t}print(){document.body.innerHTML=this.el.innerHTML,window.print(),document.location.reload()}}class i{constructor(){this.form=document.getElementById("form"),this.type=document.getElementById("type"),this.firstName=document.getElementById("firstName"),this.lastName=document.getElementById("lastName"),this.address=document.getElementById("address"),this.country=document.getElementById("country"),this.town=document.getElementById("town"),this.zip=document.getElementById("zip"),this.product=document.getElementById("product"),this.price=document.getElementById("price"),this.quantity=document.getElementById("quantity"),this.tva=document.getElementById("tva"),this.docContainer=document.getElementById("document-container"),this.hiddenDiv=document.getElementById("hiddenDiv"),this.storedEl=document.getElementById("stored-data"),this.btnPrint=document.getElementById("print"),this.btnReload=document.getElementById("reload"),this.btnStoredInvoices=document.getElementById("stored-invoices"),this.btnStoredEstimates=document.getElementById("stored-estimates"),this.submitFormListener(),this.printListener(this.btnPrint,this.docContainer),this.deleteListener(this.btnReload),this.getStoredDocsListener()}submitFormListener(){this.form.addEventListener("submit",this.handleFormSubmit)}printListener(t,e){t.addEventListener("click",(()=>{let t;t=new n(e),t.print()}))}deleteListener(t){t.addEventListener("click",(()=>{document.location.reload(),window.scrollTo(0,0)}))}getStoredDocsListener(){this.btnStoredInvoices.addEventListener("click",(()=>this.getItems("invoice"))),this.btnStoredEstimates.addEventListener("click",(()=>this.getItems("estimate")))}getItems(t){if(console.log(this),this.storedEl.hasChildNodes()&&(this.storedEl.innerHTML=""),localStorage.getItem(t)){let e;if(e=localStorage.getItem(t),null!==e&&e.length>2){let t;t=JSON.parse(e),t.map((t=>{let e=document.createElement("div"),s=document.createElement("div");e.classList.add("card","mt-5"),s.classList.add("card-body"),s.innerHTML=t,e.append(s),this.storedEl.append(e)}))}else this.storedEl.innerHTML='<div class="p-5">Aucune data disponible !</div>'}}handleFormSubmit(e){e.preventDefault(),console.log(this);const n=this.inputDatas();if(Array.isArray(n)){const[e,i,o,r,a,l,d,c,h,m,u]=n;let p,v,g=new Date;p=new t(e,i,o,r,a,l,d,c,h,m,u,g),v=new s(this.docContainer,this.hiddenDiv,this.btnPrint),v.render(p,e)}}inputDatas(){const t=this.type.value,e=this.firstName.value,s=this.lastName.value,n=this.address.value,i=this.country.value,o=this.town.value,r=this.zip.valueAsNumber,a=this.product.value,l=this.price.valueAsNumber,d=this.quantity.valueAsNumber,c=this.tva.valueAsNumber;return r>0&&l>0&&d>0&&c>0?[t,e,s,n,i,o,r,a,l,d,c]:void alert("Les valeurs numériques doivent être > 0 !")}}(function(t,e,s,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,s):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(r=(o<3?i(r):o>3?i(e,s,r):i(e,s))||r);o>3&&r&&Object.defineProperty(e,s,r)})([function(t,e,s){const n=s.value;return{get(){return n.bind(this)}}}],i.prototype,"handleFormSubmit",null),new i,e.checkLocalStorage(),console.log("Donkey Geek est super cool 2")})();